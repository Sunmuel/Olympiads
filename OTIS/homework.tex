\documentclass[12pt]{article}
\usepackage[a4paper, margin=1in]{geometry}
\usepackage{amsfonts, amssymb, amsmath, amsthm}
\usepackage{xcolor}
\usepackage{lmodern}
\usepackage{fancyhdr}
\usepackage{tcolorbox}
\usepackage{enumitem}
\usepackage{listings}
\tcbuselibrary{listings}
\usepackage[font=small, labelfont=bf, justification=centering]{caption}

\definecolor{color1}{HTML}{941b0c}
\definecolor{color2}{HTML}{bc3908}
\definecolor{color3}{HTML}{f6aa1c}
\definecolor{color4}{rgb}{0.95,0.95,0.95}

\usepackage[colorlinks=true, linkcolor=black, urlcolor=color2, citecolor=black]{hyperref}

\title{\sffamily\bfseries{OTIS Homework Problems}}
\author{Samuel de Araújo Brandão}
\date{August 24, 2025}

\renewcommand*\contentsname{\textsf{Contents}}

\pagestyle{fancy}
\fancyhf{}

\fancyhead[L]{\sffamily\bfseries{OTIS Homework Problems}}
\fancyhead[R]{\textcolor{color2}{Samuel Brandão}, August 24 2025}
\fancyfoot[C]{\thepage}
\setlength{\headheight}{14.5pt}

\tcbset{
  problembox/.style = {
    colback=white,
    colframe=color2,
    boxrule=1pt,
    arc=2mm,
    top=1pt,
    bottom=1pt,
    left=1pt,
    right=1pt,
    fonttitle=\sffamily\bfseries\color{white},
    colbacktitle=color2,
    title={Problem statement}
  }
}

\tcbset{
  claimbox/.style={
    colback=white,
    colframe=color1,
    boxrule=1pt,
  }
}

\tcbset{
  listing engine=listings,
  colback=color4,      % background color (reuse your definition)
  colframe=black!40,   % border color
  listing only,
  arc=4mm,             % corner radius
  boxrule=0.4pt,       % border thickness
  top=2pt, bottom=2pt, left=1pt, right=1pt
}

\newtcblisting{pycode}{
  listing options={
    language=Python,
    basicstyle=\ttfamily\footnotesize,
    keywordstyle=\color{color2}\bfseries,
    stringstyle=\color{color3},
    commentstyle=\color{color3}\itshape,
    numbers=left,
    numberstyle=\tiny\color{gray},
    stepnumber=1,
    numbersep=6pt,
    breaklines=true,
    showstringspaces=false,
    tabsize=4,
    columns=fullflexible,
  }
}

\begin{document}
  \maketitle

  A collection of solutions for Geometry, Inequalities and others, meant to be sent to Evan Chen, in the OTIS Application Homework.

  For some problems—such as the first geometry problem—I checked the official solution after solving them. If my solution was incorrect, I 
  revised it; if it was correct, I sometimes drew inspiration from the official solution to improve my own.

  \tableofcontents
  
  \clearpage
  
  \section{\textsf{Problems}}
    \subsection{Geometry}
      \begin{enumerate}[label=\textbf{A.\arabic*.}]
        \item \textbf{\textcolor{color2}{(USAJMO 2012, P1)}} Given a triangle $ABC$, let $P$ and $Q$ be points on segments $AB$ and $AC$, respectively, such
          that $AP = AQ$. Let $S$ and $R$ be distinct points on segment $BC$ such that $S$ lies between $B$ and $R$, $\angle BPS = \angle PRS$,
          and $\angle CQR = \angle QSR$. Prove that $P$, $Q$, $R$, $S$ are concyclic.

        \item \textbf{\textcolor{color2}{(IMO 2019, P2)}} Let $ABC$ be a triangle with circumcenter $O$. The points $P$ and $Q$ are interior points of the sides $CA$
          and $AB$ respectively. Let $K$, $L$, $M$ be the midpoints of $BP$, $CQ$, $PQ$. Suppose that $PQ$ is tangent to the circumcircle 
          of $\triangle KLM$. Prove that $OP = OQ$.

        \item \textbf{\textcolor{color2}{(USAMO 1993, P2)}} Let $ABCD$ be a quadrilateral whose diagonals are perpendicular and meet at $E$. Prove that the reflections
          of $E$ across the sides of $ABCD$ are concyclic.
      \end{enumerate}

    \subsection{Inequalities}
      \begin{enumerate}[label=\textbf{B.\arabic*.}]
        \item Suppose that $a^2 + b^2 + c^2 = 1$ for positive real numbers $a, b, c$. Find the minimum possible value of
          \[
            \frac{ab}{c} + \frac{bc}{a} + \frac{ca}{b}.
          \]
        \item Let $a, b, c$ be positive real numbers such that $a^2 + b^2 + c^2 + (a+b+c)^2 \le 4$. Prove that
          \[
            \frac{ab + 1}{(a+b)^2} + \frac{bc + 1}{(b+c)^2} + \frac{ca + 1}{(c+a)^2} \ge 3.
          \]
        \item Let $a, b, c, d$ be positive reals with $(a+c)(b+d) = 1$. Prove that
          \[
            \frac{a^3}{b+c+d} + \frac{b^3}{c+d+a} + \frac{c^3}{d+a+b} + \frac{d^3}{a+b+c} \ge \frac13.
          \]
      \end{enumerate}
    \subsection{Additional}
      \begin{enumerate}[label=\textbf{C.\arabic*.}]
        \item Write a computer program to find the number of ordered pairs of prime numbers $(p,q)$ such that when
          \[
            N = p^2 + q^3
          \]
          is written in decimal (without leading zeros), each digit from $0$ to $9$ appears exactly once. For example, $(109,1163)$ is one
          such pair because $109^2 + 1163^3 = 1573049628$.
        \item \textbf{\textcolor{color2}{(Balkan MO 1997, P4)}} Find all functions $f:\mathbb{R}\to\mathbb{R}$ for which
          \[
            f\big(xf(x)+f(y)\big)=f(x)^2+y
          \]
          holds for all real numbers $x$ and $y$.
        \item \textbf{\textcolor{color2}{(USAMO 2014, P1)}} Let $a,b,c,d$ be real numbers such that $b-d\ge 5$ and all zeros $x_1,x_2,x_3,x_4$ of the polynomial $P(x)=x^4+ax^3+bx^2+cx+d$ are 
          real. Find the smallest value the product $(x_1^2+1)(x_2^2+1)(x_3^2+1)(x_4^2+1)$ can take.
        \item \textbf{\textcolor{color2}{(USA TSTST 2017, P2)}} Ana and Banana are playing a game. First Ana picks a word, which is defined to be a nonempty sequence of capital English
          letters. Then Banana picks a nonnegative integer $k$ and challenges Ana to supply a word with exactly $k$ subsequences which are 
          equal to Ana's word. Ana wins if she is able to supply such a word, otherwise she loses. For example, if Ana picks the word “TST”,
          and Banana chooses $k=4$, then Ana can supply the word “TSTST” which has $4$ subsequences equal to Ana's word. Which words can Ana 
          pick so that she can win no matter what value of $k$ Banana chooses?
      \end{enumerate}

    \clearpage

  \section{\textsf{Geometry Solutions}}
    \
    \subsection{Problem A.1}
      \begin{tcolorbox}[problembox=Problem statement]
        Given a triangle $ABC$, let $P$ and $Q$ be points on segments $\overline{AB}$ and $\overline{AC}$,
        respectively, such that $AP = AQ$. Let $S$ and $R$ be distinct points on segment $\overline{BC}$
        such that $S$ lies between $B$ and $R$, $\angle BPS = \angle PRS$, and $\angle CQR = \angle QSR$.
        Prove that $P$, $Q$, $R$, $S$ are concyclic.
      \end{tcolorbox}
      By the $\textit{Alternate Segment Theorem}, \overline{AC}$ is tangent to $(QRS)$ and $\overline{AB}$
      is tangent to $(PRS)$. Assume for the sake of contradiction that $(QRS)$ and $(PRS)$ are distinct. In that case,
      $A \in \overline{BC}$ since $\overline{BC}$ is the radical axis and $\text{Pow}_{(QRS)}(A) =
      \text{Pow}_{(PRS)}(A)$. This leads to a contradiction, as $A \notin \overline{BC}$. Therefore,
      $P$, $Q$, $R$ and $S$ are concyclic.

    \clearpage

    \subsection{Problem A.2}
      \begin{tcolorbox}[problembox]
        Let $ABC$ be a triangle with circumcenter $O$. The points $P$ and $Q$ are interior points of the sides $CA$
        and $AB$ respectively. Let $K$, $L$, $M$ be the midpoints of $BP$, $CQ$, $PQ$. Suppose that $PQ$ is tangent to the circumcircle 
        of $\triangle KLM$. Prove that $OP = OQ$.

      \end{tcolorbox}

    \clearpage

    \subsection{Problem A.3}
      \begin{tcolorbox}[problembox]
        Let $ABCD$ be a quadrilateral whose diagonals are perpendicular and meet at $E$. Prove that the reflections
        of $E$ across the sides of $ABCD$ are concyclic.
      \end{tcolorbox}

  \clearpage

  \section{\textsf{Inequalities Solutions}}
    \subsection{Problem B.1}
      \begin{tcolorbox}[problembox]
         Suppose that $a^2 + b^2 + c^2 = 1$ for positive real numbers $a, b, c$. Find the minimum possible value of
          \[
            \frac{ab}{c} + \frac{bc}{a} + \frac{ca}{b}.
          \]
      \end{tcolorbox}
      The minimum possible value is $3\sqrt[3]{abc}$.

      The most important thing to notice is that
      \[
        \frac{ab}{c} + \frac{bc}{a} + \frac{ca}{b} = \frac{a^2b^2 + b^2c^2 + c^2a^2}{abc}
      \]
      
      can be achieved by rearranging the \textit{AM-GM inequality}, as you can see:
      \[
        \frac{a^2b^2 + b^2c^2 + c^2a^2}{3} \ge abc\sqrt[3]{abc} \implies \frac{a^2b^2 + b^2c^2 + c^2a^2}{abc} \ge 3\sqrt[3]{abc}.
      \]

    \clearpage

    \subsection{Problem B.2}
      \begin{tcolorbox}[problembox]
         Let $a, b, c$ be positive real numbers such that $a^2 + b^2 + c^2 + (a+b+c)^2 \le 4$. Prove that
          \[
            \frac{ab + 1}{(a+b)^2} + \frac{bc + 1}{(b+c)^2} + \frac{ca + 1}{(c+a)^2} \ge 3.
          \]
      \end{tcolorbox}

    \clearpage

    \subsection{Problem B.3}
      \begin{tcolorbox}[problembox]
         Let $a, b, c, d$ be positive reals with $(a+c)(b+d) = 1$. Prove that
          \[
            \frac{a^3}{b+c+d} + \frac{b^3}{c+d+a} + \frac{c^3}{d+a+b} + \frac{d^3}{a+b+c} \ge \frac13.
          \]
      \end{tcolorbox}

  \clearpage

  \section{\textsf{Additional Solutions}}
    \subsection{Problem C.1}
      \begin{tcolorbox}[problembox]
         Write a computer program to find the number of ordered pairs of prime numbers $(p,q)$ such that when
          \[
            N = p^2 + q^3
          \]
          is written in decimal (without leading zeros), each digit from $0$ to $9$ appears exactly once. For example, $(109,1163)$ is one
          such pair because $109^2 + 1163^3 = 1573049628$.
     \end{tcolorbox}
     The answer is 1270 ordered pairs. I have no idea what I'm doing...
     \begin{pycode}
        from bisect import bisect_left, bisect_right
        from math import isqrt

        def sieve(n: int) -> list[int]:
          b = bytearray(b"\x01") * (n + 1)
          b[0:2] = b"\x00\x00"
          r = isqrt(n)
          for p in range(2, r + 1):
            if b[p]:
              start = p * p
              b[start:n + 1:p] = b"\x00" * (((n - start) // p) + 1)
          return [i for i, v in enumerate(b) if v]

        def is_pandigital_0_9(x: int) -> bool:
          if x < 10**9 or x >= 10**10:
            return False
          s = str(x)
          return len(s) == 10 and set(s) == set("0123456789")

        def main() -> None:
          primes = sieve(100_000)
          primes_q = [q for q in primes if q <= 2154]
          p2 = [p * p for p in primes]
          total = 0
          for q in primes_q:
            q3 = q * q * q
            lo = 10**9 - q3
            hi = 10**10 - 1 - q3
            i0 = bisect_left(p2, max(0, lo))
            i1 = bisect_right(p2, hi)
            for i in range(i0, i1):
              if is_pandigital_0_9(p2[i] + q3):
                total += 1
          print(total)

        if __name__ == "__main__":
          main()
     \end{pycode}

    \clearpage

    \subsection{Problem C.2}
      \begin{tcolorbox}[problembox]
         Find all functions $f:\mathbb{R}\to\mathbb{R}$ for which
          \[
            f\big(xf(x)+f(y)\big)=f(x)^2+y
          \]
          holds for all real numbers $x$ and $y$.
      \end{tcolorbox}

    \clearpage

    \subsection{Problem C.3}
      \begin{tcolorbox}[problembox]
         Let $a,b,c,d$ be real numbers such that $b-d\ge 5$ and all zeros $x_1,x_2,x_3,x_4$ of the polynomial $P(x)=x^4+ax^3+bx^2+cx+d$ are 
          real. Find the smallest value the product $(x_1^2+1)(x_2^2+1)(x_3^2+1)(x_4^2+1)$ can take.
      \end{tcolorbox}
          
    \clearpage

    \subsection{Problem C.4}
      \begin{tcolorbox}[problembox]
         Ana and Banana are playing a game. First Ana picks a word, which is defined to be a nonempty sequence of capital English
          letters. Then Banana picks a nonnegative integer $k$ and challenges Ana to supply a word with exactly $k$ subsequences which are 
          equal to Ana's word. Ana wins if she is able to supply such a word, otherwise she loses. For example, if Ana picks the word “TST”,
          and Banana chooses $k=4$, then Ana can supply the word “TSTST” which has $4$ subsequences equal to Ana's word. Which words can Ana 
          pick so that she can win no matter what value of $k$ Banana chooses?
      \end{tcolorbox}

  \clearpage

  \section{\textsf{References}}
    This document was made possible thanks to the help and inspiration of the following resource:
    \renewcommand{\refname}{\vspace{-2em}}
    \begin{thebibliography}{9}
      \bibitem{noic}
      NOIC - Núcleo Olímpico de Iniciação Científica
      \textit{Potência de Ponto}, 2023.
      Available in: \url{https://noic.com.br/wp-content/uploads/2023/10/potencia.pdf}
      \bibitem{obm}
      OBM - Olimpíada Brasileira de Matemática.
      \textit{Potência de Ponto, Eixo Radical, Centro Radical e Aplicações}, 2017.
      Available in: \url{https://www.obm.org.br/content/uploads/2017/01/eixos-2.pdf}
      \bibitem{evan}
      Evan Chen.
      \textit{JMO 2012 Solution Notes}, 2025.
      Available in: \url{https://web.evanchen.cc/exams/JMO-2012-notes.pdf}
    \end{thebibliography}

\end{document}
